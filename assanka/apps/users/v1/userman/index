<?php

require_once("../appglobal");



// This file is deprecated, and should no longer be in use.  This error designed to catch cases where it is still being used.
trigger_error('Deprecated code in use', E_USER_DEPRECATED);




$users = $auth->getAllUsers();

// Create a datatable just for the filter controls
$tb = new Datatable("userlist");
$tb->addFilter("options", array("label"=>"Options", "type"=>"check", "options"=>array("norights"=>"Show users with no rights")));
$opts = $tb->getFilterValue('options');
$shownorights = (is_array($opts) and in_array('norights', $opts));

$icl = new Iconlist();
foreach($users as $user) {
	if (!$shownorights and !$auth->getRightsForUser($user)) continue;
	$icl->addItem($user, "userman/view?id=".$user, "usr");
}
$page->add("content", $icl->output());

if ($auth->checkRights("users.add", false)) $page->addAction("Add user", "userman/edit");

$page->set("title", "View users");
$op = $tb->getOutput();
$page->add("rightnav", $op['rightnav']);
$page->outputHTML();
?>

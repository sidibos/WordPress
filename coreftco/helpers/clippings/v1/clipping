<?php
/**
 * A single clipped item
 *
 * @codingstandard ftlabs-phpcs
 * @copyright The Financial Times Limited [All Rights Reserved]
 */

require_once $_SERVER['COREFTCO'].'/helpers/ftapi/v1/FTItem';

class ClippingV1 {
	public $url, $title, $description, $datesaved;

	function __construct($url, array $metadata = null) {
		$this->url = $url;
		if ($metadata) {
			$this->setMetaData($metadata);
		}
	}

	private function setMetaData($metadata) {
		if (isset($metadata['title'])) {
			$this->title = $metadata['title'];
		}

		if (isset($metadata['description'])) {
			$this->description = $metadata['description'];
		}

		if (isset($metadata['datesaved'])) {
			$this->datesaved = Common::convertHumanTime($metadata['datesaved']);
		}
	}

	public static function fromUUID($uuid) {
		$ftitem = FTItemV1::get(new FTAPIConnectionV1(), $uuid);
		if ($ftitem) {
			return new ClippingV1($ftitem->location['uri']);
		}

		return null;
	}

	public static function fromData($data) {
		if (!empty($data['url'])) {
			return new ClippingV1($data['url'], $data);
		}

		if (!empty($data['uuid'])) {
			$clipping = self::fromUUID($data['uuid']);
			if ($clipping) {
				$clipping->setMetaData($data);
				return $clipping;
			}
		}

		return null;
	}
}
<?php
/**
 * Test for AssankaLoggerV1 - logging to STDOUT
 *
 * @codingstandard ftlabs-phpcs
 * @copyright The Financial Times Limited [All rights reserved]
 */


class stdoutLoggerTest extends PHPUnit_Framework_TestCase {
	protected $logger;

	protected function setUp() {
		$this->logger = new AssankaLoggerV1("testlogger");
		$this->logger->setLogMethod("stdout");
	}
	public function testCanLogString() {
		$outputstring = "나는 유리를 먹을 수 있어요. 그래도 아프지 않아요";

		$this->expectOutputString($outputstring."\n");
		$this->logger->write($outputstring);
	}
	public function testCanLogArray() {
		$arraytolog = array(
			'boolean' => true,
			'unicode' => "მინას",
			'has spaces' => "yes I have spaces",
			'has=equals' => "got=equals",
		);
		$this->expectOutputString("boolean=true unicode=მინას has_spaces=yes_I_have_spaces has_equals=got_equals\n");
		$this->logger->write($arraytolog);
	}
	public function testCanLogArrayWithInstanceVariables() {
		$this->logger->setInstanceVariables(array(
			'boolean' => false,
			'ip address' => "127.0.0.1",
		));
		$arraytolog = array(
			'boolean' => true,
			'unicode' => "მინას",
			'has spaces' => "yes I have spaces",
			'has=equals' => "got=equals",
		);
		$this->expectOutputString("boolean=true ip_address=127.0.0.1 unicode=მინას has_spaces=yes_I_have_spaces has_equals=got_equals\n");
		$this->logger->write($arraytolog);
	}
	public function testDoesntBreakOnReinitialisation() {
		$this->expectOutputString("");
		$this->logger->reinitialise();
	}
}
